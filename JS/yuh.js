var bruh=new Audio("click.mp3"),focused_datapoint=null,datapoints=[],current_datatype="",POPUP_MODE=!1,SIDEBAR={title:0,description:0,image:0},POPUP={element:null,header:null,dtype:null,audio:null,text:null};async function setup_local(){print("Starting local setup"),SIDEBAR={};let[t,e,a]=gid("desktop-sidebar").children;SIDEBAR.title=t,SIDEBAR.description=e,SIDEBAR.image=a;let s=gid("datapoint-popup"),[i,n,o,l]=gid("popup-info").children;POPUP={element:s,header:i,dtype:n,audio:o,text:l},setup_datatype_links(),setup_close_buttons(),setup_datapoint_numbers(),set_datapoint_events(),set_datapoint_expansion_sizes(),document.body.classList.add("classic-layout")}function resize_handler_local(){set_datapoint_expansion_sizes()}function is_classic_layout(){return!mobile_mode&&document.body.classList.contains("classic-layout")}function setup_datatype_links(){for(const t of gid("datapoint-types-inner").children)t.onclick=(e=>{t.classList.add("datatype-selected"),current_datatype&&gid(current_datatype).classList.remove("shown"),current_datatype=t.getAttribute("target"),[...document.getElementsByClassName("datatype-poster")].forEach(t=>{t.src=`Images/${current_datatype.startsWith("Text")?"text":current_datatype.toLowerCase()}-poster.png`}),gid("datatype-container").classList.add("shown"),gid(current_datatype).classList.add("shown"),gid("datapoint-types").classList.remove("shown"),datapoints=gid(current_datatype).querySelector(".datapoint-container").children,is_classic_layout()&&focus_datapoint(datapoints[0])})}function setup_close_buttons(){for(const t of document.querySelectorAll(".datatype-title > img"))t.onclick=(e=>{if(t.parentElement.parentElement.classList.remove("shown"),gid("datatype-container").classList.remove("shown"),gid("datapoint-types").classList.add("shown"),focused_datapoint&&focused_datapoint.getAttribute("media-type")){let t=focused_datapoint.querySelector("audio");t.pause(),t.currentTime=0}})}function setup_datapoint_numbers(){[...document.getElementsByClassName("datapoint-container")].forEach(t=>{[...t.children].forEach((t,e)=>{t.setAttribute("position",e+1);let a=t.getAttribute("media-type");if(a){let s=t.querySelector(".datapoint-audio");s.onclick=(t=>t.stopPropagation());let i=s.firstElementChild;i.onclick=(t=>{t.stopPropagation(),toggle_audio_playback(i.previousElementSibling)});let n=document.createElement("AUDIO");n.preload="metadata",t.lastElementChild.firstElementChild.prepend(n),n.src=`Audio/HZD ${a} ${e+1}.mp3`,n.addEventListener("timeupdate",function(){update_progress_bar(this)}),n.onended=(t=>{n.parentElement.classList.remove("playing")})}})});let t=gid("popup-content"),e=t.querySelector(".datapoint-audio").children[1];e.onclick=(t=>{t.stopPropagation(),toggle_audio_playback(e.previousElementSibling)});let a=t.querySelector("audio");a.addEventListener("timeupdate",function(){update_progress_bar(this)}),a.onended=(t=>{a.parentElement.classList.remove("playing")})}function close_popup(){POPUP_MODE=!1,POPUP.element.classList.remove("shown"),gid("popup-content").getAttribute("media-type")&&(POPUP.audio.classList.remove("playing"),POPUP.audio.firstElementChild.pause(),POPUP.audio.firstElementChild.currentTime=0)}function set_datapoint_expansion_sizes(){for(const t of document.getElementsByClassName("datapoint")){let e=t.querySelector("text").offsetHeight;t.style=`--datapoint-text-size: ${e}px`}}function set_datapoint_events(){for(const t of document.getElementsByClassName("datapoint")){t.firstElementChild.onclick=(t=>{t.stopPropagation(),select_datapoint()}),t.onmouseover=(e=>{focus_datapoint(t)}),t.onclick=(e=>{is_classic_layout()?init_popup(t):select_datapoint()})}}function init_popup(t){POPUP_MODE=!0;let e=t.getAttribute("media-type");e&&gid("popup-content").setAttribute("media-type",e),POPUP.header.innerHTML=t.firstElementChild.firstElementChild.innerHTML,POPUP.dtype.innerHTML=current_datatype,e&&(POPUP.audio.firstElementChild.src=t.getElementsByTagName("audio")[0].src),POPUP.text.innerHTML=t.lastElementChild.lastElementChild.innerHTML,POPUP.element.classList.add("shown")}function focus_datapoint(t){focused_datapoint!=t&&(focused_datapoint&&focused_datapoint.classList.remove("focused"),focused_datapoint=t,t.classList.add("focused"),SIDEBAR.title.innerHTML=t.firstElementChild.firstElementChild.innerHTML,SIDEBAR.description.innerHTML=t.getAttribute("description"))}function select_datapoint(){let t=document.querySelector(".datapoint.selected");if(t==focused_datapoint)return t.classList.remove("selected"),void(t.getAttribute("media-type")&&(t.getElementsByTagName("audio")[0].pause(),t.getElementsByTagName("audio")[0].currentTime=0,t.getElementsByTagName("audio")[0].parentElement.classList.remove("playing")));t&&(t.getAttribute("media-type")&&t.getElementsByTagName("audio")[0].pause(),t.classList.remove("selected")),focused_datapoint.classList.add("selected")}function prepare_datapoint_expansions(){for(const t of document.getElementsByClassName("datapoint-title")){let e=t.parentElement;t.onclick=(t=>{is_classic_layout()||(e.classList.contains("selected")?e.classList.remove("selected"):e.classList.add("selected"))})}for(const t of document.getElementsByClassName("datapoint"))t.onmouseover=(e=>{is_classic_layout()&&!t.classList.contains("selected")&&(document.querySelector(".datapoint.selected").classList.remove("selected"),t.classList.add("selected"),new Audio("click2.mp3").play())}),t.onclick=(e=>{is_classic_layout()&&activate_datapoint(t)})}function setup_key_presses(){document.body.onkeydown=(t=>{let e=t.key;if(POPUP_MODE)"f"==e?toggle_audio_playback(POPUP.audio.firstElementChild):"Escape"==e&&close_popup();else if("q"==e)go_to_previous_page();else if("e"==e)go_to_next_page();else if("Tab"==e)t.preventDefault(),toggle_layout();else if("f"==e)is_classic_layout()?init_popup(focused_datapoint):select_datapoint();else if(is_classic_layout()){let t=parseInt(getComputedStyle(gid(current_datatype).getElementsByClassName("datapoint-container")[0]).getPropertyValue("--columns")),a=0,s=parseInt(focused_datapoint.getAttribute("position"));if("w"==e||"ArrowUp"==e)a=s-t;else if("s"==e||"ArrowDown"==e)a=s+t;else if("d"==e||"ArrowRight"==e)a=s+1;else{if("a"!=e&&"ArrowLeft"!=e)return;a=s-1}focus_datapoint(datapoints[Math.max(1,Math.min(datapoints.length,a))-1])}else if("w"==e||"ArrowUp"==e){let t=focused_datapoint.previousElementSibling;t&&(focus_datapoint(t),t.parentElement.click(),t.scrollIntoView({block:"center"}))}else if("s"==e||"ArrowDown"==e){let t=focused_datapoint.nextElementSibling;t&&(focus_datapoint(t),t.parentElement.click(),t.scrollIntoView({block:"center"}))}else print(e)})}function toggle_layout(){document.body.classList.contains("classic-layout")?document.body.classList.remove("classic-layout"):document.body.classList.add("classic-layout")}function toggle_audio_playback(t){t.paused?(t.play(),t.parentElement.classList.add("playing")):(t.pause(),t.parentElement.classList.remove("playing"))}function update_progress_bar(t){t.parentElement.style=`--perc: ${100*t.currentTime/t.duration}%`}